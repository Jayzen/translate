<%= form_tag '/words/interpret', method: :get do %>  
  <div class="form-row d-flex flex-row justify-content-center">
    <div class="form-group col-md-2">
      <%= collection_select :word, :tag_id, current_user.tags.order("updated_at desc"), :id, :name, {}, { class: "form-control" } %>
    </div>
    <div class="form-group col-md-3">
      <%= text_field_tag :name, nil, class: "form-control" %>
    </div>
    <div class="form-group">
      <%= submit_tag "翻译/查询", class: "btn btn-primary form-control" %>
    </div>  
  </div>  
<% end -%>

<div class="text-center mb-3 mt-2">
  <%= link_to "标记", unfamiliar_words_path, class: "badge badge-danger" %>
  <%= link_to "全部", words_path, class: "badge badge-success" %>
  <% current_user.tags.includes(:words).each do |tag| %>
    <% unless tag.words.length == 0 %>
      <%= link_to "#{tag.name}", tags_words_path(tag_id: tag.id), class: "badge badge-success" %>
    <% end %>  
  <% end %>
</div>
<table class="table table-sm bg-white mb-1">
  <tbody>
    <% @words.each_with_index do |word, index| %>
      <tr>
        <td class="text-left text-secondary">
          <%= index+((params[:page] || 1).to_i - 1)*10+1 %>. &nbsp
          <%= word.name %>
          <span id="<%= word.id %>-status-explain">
            <span class="badge badge-danger"><%= word.status == false ? "标记" : ""%></span>
          </span>
        </td>
        <td></td>
        <td class="text-right">
          <span id="<%= word.id %>-status">
            <% if word.status? %>
              <%= link_to "标记", status_word_path(word), class: "badge badge-danger", remote: true%>
            <% else %>
              <%= link_to "取消标记", status_word_path(word), class: "badge badge-success", remote: true%>
            <% end -%>
          </span>
          <button class="badge badge-primary" data-toggle="modal" data-target="#<%=word.id %>-modal">翻译</button>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= paginate @words %>

<% @words.each do |word| %>
  <div class="modal" id="<%= word.id%>-modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><%= word.name %></h5>
        </div>
        <div class="modal-body">
          <p class="card-text"><strong>美音音标:</strong> &nbsp&nbsp <%= word.us %></p>
          <p class="card-text"><strong>英音音标:</strong> &nbsp&nbsp <%= word.uk %></p>
          <p class="card-text"><strong>中文翻译:</strong> &nbsp&nbsp <%= word.chinese %></p> 
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" data-dismiss="modal">关闭</button>
        </div>
      </div>
    </div>
  </div>
<% end %>

